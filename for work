import pandas as pd

# Load the messy data and vendor list
def process_data(messy_file, vendor_file, output_file):
    # Read the messy data and vendor list from Excel files
    messy_data = pd.read_excel(messy_file)
    vendor_list = pd.read_excel(vendor_file)
    
    # Ensure the vendor list is a single column of strings
    vendor_names = vendor_list['Vendor'].str.strip().tolist()
    
    # Define a function to replace cells entirely with "VendorName" if a match is found
    def replace_with_vendor(text):
        if pd.isnull(text):  # Handle missing values
            return text
        for vendor in vendor_names:
            if vendor.lower() in str(text).lower():  # Case-insensitive match
                return "VendorName"
        return text  # Return original text if no match found
    
    # Apply the replacement function to all text columns in messy data
    for column in messy_data.select_dtypes(include='object').columns:
        messy_data[column] = messy_data[column].apply(replace_with_vendor)
    
    # Save the cleaned data to a new Excel file
    messy_data.to_excel(output_file, index=False)
    print(f"Cleaned data saved to {output_file}")

# Example usage
messy_file = "messy_data.xlsx"  # Replace with your input file
vendor_file = "vendor_list.xlsx"  # Replace with your vendor list file
output_file = "cleaned_data.xlsx"  # Replace with your desired output file

process_data(messy_file, vendor_file, output_file)
